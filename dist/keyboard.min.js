angular.module("keyboard",[]),angular.module("keyboard").constant("undefined"),angular.module("keyboard").factory("KbContainerController",["undefined","$log",function(e,t){"use strict";function i(t){this.ngModel=e,this.selected=[],this.multiple=!1,this.active=e,this._element=t[0]}return i.$inject=["$element"],angular.extend(i.prototype,{initialize:function(e){angular.extend(this,e),this.ngModel.$render=function(){this.multiple?(this.selected=this.ngModel.$viewValue,angular.isArray(this.selected)===!1&&(angular.isDefined(this.selected)&&t.error(this.identifier,"ng-model(multiple) must be an array, got:",this.selected),this.selected=[])):this.selected[0]=this.ngModel.$viewValue;for(var e in this.selected){var i=this._locate(this.selected[e]);if(i){this.active=i;break}}}.bind(this)},select:function(e){this.multiple?this.isSelected(e)===!1&&(this.selected.push(e),this.ngModel.$setViewValue(this.selected)):(this.selected[0]=e,this.ngModel.$setViewValue(e))},deselect:function(e){var t=this.selected.indexOf(e);-1!==t&&this.selected.splice(t,1)},toggle:function(e){this.isSelected(e)?this.deselect(e):this.select(e)},isSelected:function(e){return-1!==this.selected.indexOf(e)},previous:function(){var e=this._getSiblingItems(this.active).previous;return e?(this.active=e,!0):!1},next:function(){var e=this._getSiblingItems(this.active).next;return e?(this.active=e,!0):!1},activate:function(){return t.$error(this.identifier,"activate() is not implemented"),!1},invoke:function(){return t.$error(this.identifier,"invoke() is not implemented"),!1},_locate:function(e){for(var t=this._element.querySelectorAll("[kb-item]"),i=0;i<t.length;i++){var n=angular.element(t.item(i)).controller("kbItem");if(n.model===e)return n}},_getSiblingItems:function(e){for(var t=e.element[0],i=this._element.querySelectorAll("[kb-item]"),n=0;n<i.length;n++){var o=i.item(n);if(o===t){var r={};return 0!==n&&(r.previous=angular.element(i.item(n-1)).controller("kbItem")),n<i.length-1&&(r.next=angular.element(i.item(n+1)).controller("kbItem")),r}}return{}},_first:function(){var e=this._element.querySelector("[kb-item]");return e?e.controller("kbItem"):void 0}}),i}]),angular.module("keyboard").factory("KbItemController",["kbFocus",function(e){"use strict";function t(e){this.element=e}return t.$inject=["$element"],angular.extend(t.prototype,{focus:function(){this.element.attr("tabindex",0),e(this.element)}}),t}]),angular.module("keyboard").directive("kbItem",["KbItemController","$animate","$log",function(e,t,i){"use strict";return{controller:e,require:["kbItem","?^kbList","?^kbSelect"],link:function(e,n,o,r){function l(e,t,i){return"left"===e&&i.left<t.left?t.left-i.left:"up"===e&&i.top<t.top?t.top-i.top:"right"===e&&i.left>t.left?i.left-t.left:"down"===e&&i.top>t.top?i.top-t.top:0}for(var a=r[0],c=r[1],s=1;s<r.length;s++)r[s]&&(c=r[s]);if(!c)return void i.error("Controller 'kbList' or 'kbSelect', required by directive 'kbItem', can't be found!");var u=o.kbSelectedClass||"kb-selected",d=o.kbActiveClass||"kb-active";a.model=e.$eval(o.kbItem),e.$watch(o.kbItem,function(e){a.model=e}),"undefined"==typeof c.active?c.active=a:c.isSelected(a.model)&&c.isSelected(c.active.model)===!1&&(c.active=a),e.$watch(function(){return c.isSelected(a.model)},function(e){e?t.addClass(n,u):t.removeClass(n,u)}),e.$watch(function(){return c.active===a},function(e){e?(n.attr("tabindex",0),t.addClass(n,d)):(t.removeClass(n,d),n.is("a")||n.is("button")?n.attr("tabindex",0):n.removeAttr("tabindex"))});var f={37:"left",38:"up",39:"right",40:"down"};n.on("keydown",function(t){var i=!1;if(t.which>=37&&t.which<=40){var o=c._getSiblingItems(a),r=n[0].getBoundingClientRect();o.previous&&l(f[t.which],r,o.previous.element[0].getBoundingClientRect())&&(c.activate(o.previous),i=!0),o.next&&l(f[t.which],r,o.next.element[0].getBoundingClientRect())&&(c.activate(o.next),i=!0)}else(32===t.which||13===t.which)&&(i=c.invoke(a));i&&(t.preventDefault(),e.$apply())}),n.on("click",function(){c.activate(a),c.invoke(a),e.$apply()}),e.$on("$destroy",function(){c.active=c._first()})}}}]),angular.module("keyboard").directive("kbList",["KbContainerController","$parse",function(e){"use strict";return{controller:e,require:["kbList","ngModel"],link:function(e,t,i,n){var o=n[0];o.initialize({identifier:"[kb-list]",ngModel:n[1],activate:function(e){this.active=e,this.select(e.model),e.focus()},invoke:function(){return!1}})}}}]),angular.module("keyboard").directive("kbSelect",["KbContainerController",function(e){"use strict";return{controller:e,require:["kbSelect","ngModel"],link:function(e,t,i,n){var o=n[0];o.initialize({identifier:"[kb-select]",ngModel:n[1],multiple:angular.isDefined(i.multiple),activate:function(e){this.active=e,e.focus()},invoke:function(e){return this.toggle(e.model),!0}})}}}]),angular.module("keyboard").factory("kbFocus",["kbScrollTo",function(){return function(e){e.focus()}}]),angular.module("keyboard").factory("kbScrollTo",["$window",function(e){function t(e,t,i,n){if(n&&angular.element.prototype.animate){var o=angular.element(e),r={};return r[t]=i,o.animate(r,n),function(){o.stop(!0,!0)}}return e[t]=i,angular.noop}function i(o,r,l){for(var a=angular.noop,c=o.parentElement;c.nodeName!==n;){var s=getComputedStyle(c),u=s.overflow+s.overflowX+s.overflowY;if(u.match(/scroll|hidden/))break;c=c.parentElement}var d=o.getBoundingClientRect(),f={top:Math.ceil(d.top),right:Math.ceil(d.right),bottom:Math.ceil(d.bottom),left:Math.ceil(d.left)};if(c.nodeName===n)var h={top:0,right:e.innerWidth,bottom:e.innerHeight,left:0};else var m=c.getBoundingClientRect(),h={top:Math.ceil(m.top),right:Math.ceil(m.right),bottom:Math.ceil(m.bottom),left:Math.ceil(m.left)};var v=f.top-h.top,g=h.right-f.right,b=h.bottom-f.bottom,p=f.left-h.left;if(v+r.top<0?(a=t(c,"scrollTop",c.scrollTop+v+r.top,l),b+=v,v=0):b+r.bottom<0&&(a=t(c,"scrollTop",c.scrollTop-b+r.bottom,l),v+=b,b=0),p+r.left<0?(a=t(c,"scrollLeft",c.scrollLeft+p+r.left,l),g+=p,p=0):g+r.right<0&&(a=t(c,"scrollLeft",c.scrollLeft-g+r.right,l),p+=g,g=0),c.nodeName===n)return a;var k=i(c,{top:v,right:v,bottom:b,left:p},l);return function(){a(),k()}}var n="BODY";return navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(n="HTML"),i}]);
//# sourceMappingURL=keyboard.min.js.map