angular.module("keyboard",[]),angular.module("keyboard").constant("undefined"),angular.module("keyboard").factory("KbContainerController",["undefined","$parse",function(e,t){"use strict";function n(t){this.selected=[],this.multiple=!1,this.active=e,this._element=t[0],this.itemAvailable=!1}return n.$inject=["$element"],angular.extend(n.prototype,{activate:function(e){this.active=e,e.focus()},invoke:function(){return!1},select:function(e){this.multiple?this.isSelected(e)===!1&&(this.selected.push(e),this.setModel(this.selected)):(this.selected[0]=e,this.setModel(e))},deselect:function(e){var t=this.selected.indexOf(e);-1!==t&&this.selected.splice(t,1)},toggle:function(e){this.isSelected(e)?this.deselect(e):this.select(e)},isSelected:function(e){return-1!==this.selected.indexOf(e)},previous:function(){var e=this._getSiblingItems(this.active).previous;return e?(this.active=e,!0):!1},next:function(){var e=this._getSiblingItems(this.active).next;return e?(this.active=e,!0):!1},_locate:function(e){for(var t=this._element.querySelectorAll("[kb-item]"),n=0;n<t.length;n++){var i=angular.element(t.item(n)).controller("kbItem");if(i.getModel()===e)return i}},_getSiblingItems:function(e){for(var t=e.element[0],n=this._element.querySelectorAll("[kb-item]"),i=0;i<n.length;i++){var o=n.item(i);if(o===t){var r={};return 0!==i&&(r.previous=angular.element(n.item(i-1)).controller("kbItem")),i<n.length-1&&(r.next=angular.element(n.item(i+1)).controller("kbItem")),r}}return{}},first:function(){var e=this._element.querySelector("[kb-item]");return e?e.controller("kbItem"):void 0},bind:function(e,n){var i=t(n);this.getModel=function(t){return i(e,t)},this.setModel=function(t){return i.assign(e,t)},this.multiple?this.selected=this.getModel()||[]:this.selected[0]=this.getModel()}}),n}]),angular.module("keyboard").factory("KbItemController",["kbFocus",function(e){"use strict";function t(e){this.element=e}return t.$inject=["$element"],angular.extend(t.prototype,{focus:function(){this.element.attr("tabindex",0),e(this.element)}}),t}]),angular.module("keyboard").directive("kbItem",["KbItemController","$animate","$log",function(e,t,n){"use strict";return{controller:e,require:["kbItem","?^kbList","?^kbSelect"],link:function(e,i,o,r){function l(e,t,n){return"left"===e&&n.left<t.left?t.left-n.left:"up"===e&&n.top<t.top?t.top-n.top:"right"===e&&n.left>t.left?n.left-t.left:"down"===e&&n.top>t.top?n.top-t.top:0}for(var c=r[0],a=r[1],u=1;u<r.length;u++)r[u]&&(a=r[u]);if(!a)return void n.error("Controller 'kbList' or 'kbSelect', required by directive 'kbItem', can't be found!");var s=o.kbSelectedClass||"kb-selected",f=o.kbActiveClass||"kb-active";c.model=e.$eval(o.kbItem),e.$watch(o.kbItem,function(e){c.model=e}),angular.isUndefined(a.active)?a.active=c:a.isSelected(c.model)&&a.isSelected(c.active)===!1&&(a.active=c),e.$watch(function(){return a.isSelected(c.model)},function(e){e?t.addClass(i,s):t.removeClass(i,s)}),e.$watch(function(){return a.active===c},function(e){e?(i.attr("tabindex",0),t.addClass(i,f)):(t.removeClass(i,f),i.is("a")||i.is("button")?i.attr("tabindex",0):i.removeAttr("tabindex"))});var d={37:"left",38:"up",39:"right",40:"down"};i.on("keydown",function(t){var n=!1;if(t.which>=37&&t.which<=40){var o=a._getSiblingItems(c),r=i[0].getBoundingClientRect();o.previous&&l(d[t.which],r,o.previous.element[0].getBoundingClientRect())&&(a.activate(o.previous),n=!0),o.next&&l(d[t.which],r,o.next.element[0].getBoundingClientRect())&&(a.activate(o.next),n=!0)}else(32===t.which||13===t.which)&&(n=a.invoke(c));n&&(t.preventDefault(),e.$apply())}),i.on("click",function(){a.activate(c),a.invoke(c),e.$apply()}),e.$on("$destroy",function(){a.active=a.first()})}}}]),angular.module("keyboard").directive("kbList",["KbContainerController","$parse",function(e){"use strict";return{controller:e,require:"kbList",link:function(t,n,i,o){o.activate=function(t){return this.select(t.model),e.prototype.activate.apply(this,arguments)},o.bind(t,i.kbList),t.$watch(function(){return o.selected},function(){"multiselect"===o.mode})}}}]),angular.module("keyboard").directive("kbSelect",["KbContainerController",function(e){"use strict";return{controller:e,require:"kbSelect",link:function(e,t,n,i){i.invoke=function(e){return this.toggle(e.model),!0},i.bind(e,n.kbSelect),e.$watch(function(){return i.selected},function(){"multiselect"===i.mode})}}}]),angular.module("keyboard").factory("kbFocus",["kbScrollTo",function(){return function(e){e.focus()}}]),angular.module("keyboard").factory("kbScrollTo",["$window",function(e){function t(e,t,n,i){if(i&&angular.element.prototype.animate){var o=angular.element(e),r={};return r[t]=n,o.animate(r,i),function(){o.stop(!0,!0)}}return e[t]=n,angular.noop}function n(o,r,l){for(var c=angular.noop,a=o.parentElement;a.nodeName!==i;){var u=getComputedStyle(a),s=u.overflow+u.overflowX+u.overflowY;if(s.match(/scroll|hidden/))break;a=a.parentElement}var f=o.getBoundingClientRect(),d={top:Math.ceil(f.top),right:Math.ceil(f.right),bottom:Math.ceil(f.bottom),left:Math.ceil(f.left)};if(a.nodeName===i)var h={top:0,right:e.innerWidth,bottom:e.innerHeight,left:0};else var m=a.getBoundingClientRect(),h={top:Math.ceil(m.top),right:Math.ceil(m.right),bottom:Math.ceil(m.bottom),left:Math.ceil(m.left)};var b=d.top-h.top,v=h.right-d.right,g=h.bottom-d.bottom,p=d.left-h.left;if(b+r.top<0?(c=t(a,"scrollTop",a.scrollTop+b+r.top,l),g+=b,b=0):g+r.bottom<0&&(c=t(a,"scrollTop",a.scrollTop-g+r.bottom,l),b+=g,g=0),p+r.left<0?(c=t(a,"scrollLeft",a.scrollLeft+p+r.left,l),v+=p,p=0):v+r.right<0&&(c=t(a,"scrollLeft",a.scrollLeft-v+r.right,l),p+=v,v=0),a.nodeName===i)return c;var k=n(a,{top:b,right:b,bottom:g,left:p},l);return function(){c(),k()}}var i="BODY";return navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(i="HTML"),n}]);
//# sourceMappingURL=keyboard.min.js.map